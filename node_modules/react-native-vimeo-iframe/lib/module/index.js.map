{"version":3,"sources":["index.tsx"],"names":["React","useCallback","useRef","WebView","template","PlayerEvents","Vimeo","handlers","handlersArr","videoId","params","reference","otherProps","webRef","url","autoPlay","includes","registerHandlers","forEach","name","onBridgeMessage","event","payload","JSON","parse","nativeEvent","data","bridgeMessageHandler","uri","headers","Referer"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,MAA7B,QAA2C,OAA3C;AACA,SAASC,OAAT,QAAwB,sBAAxB;AAEA,OAAOC,QAAP,MAAqB,YAArB;AACA,SAAsBC,YAAtB,QAA0C,SAA1C;AAEA,OAAO,MAAMC,KAA4B,GAAG,CAAC;AAC3CC,EAAAA,QAAQ,EAAEC,WADiC;AAE3CC,EAAAA,OAF2C;AAG3CC,EAAAA,MAH2C;AAI3CC,EAAAA,SAJ2C;AAK3C,KAAGC;AALwC,CAAD,KAMtC;AACJ,QAAMC,MAAM,GAAGX,MAAM,EAArB;AACA,QAAMY,GAAW,GAAGJ,MAAM,GACrB,kCAAiCD,OAAQ,IAAGC,MAAO,EAD9B,GAErB,kCAAiCD,OAAQ,EAF9C;AAIA,QAAMM,QAAQ,GAAGL,MAAH,aAAGA,MAAH,uBAAGA,MAAM,CAAEM,QAAR,CAAiB,YAAjB,CAAjB;AAEA,QAAMT,QAAa,GAAG,EAAtB;AAEA,QAAMU,gBAAgB,GAAGhB,WAAW,CAAC,MAAM;AACzCI,IAAAA,YAAY,CAACa,OAAb,CAAsBC,IAAD,IAAU;AAC7B,UAAIX,WAAJ,EAAiBD,QAAQ,CAACY,IAAD,CAAR,GAAiBX,WAAW,CAACW,IAAD,CAA5B;AAClB,KAFD;AAGD,GAJmC,EAIjC,CAACZ,QAAD,EAAWC,WAAX,CAJiC,CAApC;AAMAS,EAAAA,gBAAgB;AAEhB,QAAMG,eAAe,GAAGnB,WAAW,CAChCoB,KAAD,IAAgB;AACd,UAAMC,OAAoC,GAAGC,IAAI,CAACC,KAAL,CAC3CH,KAAK,CAACI,WAAN,CAAkBC,IADyB,CAA7C;AAIA,QAAIC,oBAAoB,GAAGpB,QAAQ,CAACe,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEH,IAAV,CAAnC;AACA,QAAIQ,oBAAJ,EAA0BA,oBAAoB,CAACL,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEI,IAAV,CAApB;AAC3B,GARgC,EASjC,CAACnB,QAAD,CATiC,CAAnC;AAYA,sBACE,oBAAC,OAAD;AACE,IAAA,qBAAqB,EAAE,IADzB;AAEE,IAAA,MAAM,EAAE;AAAEqB,MAAAA,GAAG,EAAEd,GAAP;AAAYe,MAAAA,OAAO,EAAE;AAAEC,QAAAA,OAAO,EAAEnB;AAAX;AAArB,KAFV;AAGE,IAAA,iBAAiB,EAAE,IAHrB;AAIE,IAAA,GAAG,EAAEE,MAJP;AAKE,IAAA,SAAS,EAAEO,eALb;AAME,IAAA,aAAa,EAAE,KANjB;AAOE,IAAA,kBAAkB,EAAEhB,QAAQ,CAACU,GAAD,CAP9B;AAQE,IAAA,+BAA+B,EAAE,CAACC;AARpC,KASMH,UATN,EADF;AAaD,CAjDM","sourcesContent":["import React, { useCallback, useRef } from 'react'\nimport { WebView } from 'react-native-webview'\n\nimport template from './template'\nimport { LayoutProps, PlayerEvents } from './types'\n\nexport const Vimeo: React.FC<LayoutProps> = ({\n  handlers: handlersArr,\n  videoId,\n  params,\n  reference,\n  ...otherProps\n}) => {\n  const webRef = useRef<WebView>()\n  const url: string = params\n    ? `https://player.vimeo.com/video/${videoId}?${params}`\n    : `https://player.vimeo.com/video/${videoId}`\n\n  const autoPlay = params?.includes('autoplay=1')\n\n  const handlers: any = {}\n\n  const registerHandlers = useCallback(() => {\n    PlayerEvents.forEach((name) => {\n      if (handlersArr) handlers[name] = handlersArr[name]\n    })\n  }, [handlers, handlersArr])\n\n  registerHandlers()\n\n  const onBridgeMessage = useCallback(\n    (event: any) => {\n      const payload: { name: string; data: any } = JSON.parse(\n        event.nativeEvent.data\n      )\n\n      let bridgeMessageHandler = handlers[payload?.name]\n      if (bridgeMessageHandler) bridgeMessageHandler(payload?.data)\n    },\n    [handlers]\n  )\n\n  return (\n    <WebView\n      allowsFullscreenVideo={true}\n      source={{ uri: url, headers: { Referer: reference } }}\n      javaScriptEnabled={true}\n      ref={webRef as any}\n      onMessage={onBridgeMessage}\n      scrollEnabled={false}\n      injectedJavaScript={template(url)}\n      mediaPlaybackRequiresUserAction={!autoPlay}\n      {...otherProps}\n    />\n  )\n}\n"]}